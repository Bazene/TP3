<?php
    include_once "../Includes/i_redurection_log_in.php";
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customers</title>
    <?php include_once "../Includes/i_header.php";?>
    <?php include_once "../Includes/i_links.php";?>
    <link rel="stylesheet" href="../Style/s_customers.css">
    <script src="../JS_Files/j_customers.js" defer></script>
</head>

<body> 
        <?php include_once "../Controllers/getCustomers.php";?>
        <?php include_once "../Controllers/getCustomerSearch.php";?>

        <section class="customer_search">
            <form method="POST" action="" enctype="multipart/form-data">
                <input type="number" name="id_search" placeholder="customer search" style="width:200px; padding:7px">
                <input type="submit" value="Search" style="width:100px; margin-left:10px; background-color:rgb(13, 13, 155); color:white; cursor:pointer; border:0px;">
            </form>
        </section>
        
        <?php
            if(customer_search() && customer_search() != "incorrect_id") {
                $customers = [customer_search()];
            }
            elseif (customer_search()=="incorrect_id") {
                echo 
                "
                    <section class=\"print_customer\" style='flex-direction:column ; justify-content:space-around;'>
                        <div style='width:100px; height:128px; margin-bottom:0px;'>
                            <svg viewBox=\"0 0 704 896\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">
                            <path d=\"M672 0H32C14.3 0 0 14.3 0 32V864C0 881.7 14.3 896 32 896H672C689.7 896 704 881.7 704 864V32C704 14.3 689.7 0 672 0ZM72 72H632V280H72V72ZM632 552H72V344H632V552ZM632 824H72V616H632V824ZM144 176C144 186.609 148.214 196.783 155.716 204.284C163.217 211.786 173.391 216 184 216C194.609 216 204.783 211.786 212.284 204.284C219.786 196.783 224 186.609 224 176C224 165.391 219.786 155.217 212.284 147.716C204.783 140.214 194.609 136 184 136C173.391 136 163.217 140.214 155.716 147.716C148.214 155.217 144 165.391 144 176ZM144 448C144 458.609 148.214 468.783 155.716 476.284C163.217 483.786 173.391 488 184 488C194.609 488 204.783 483.786 212.284 476.284C219.786 468.783 224 458.609 224 448C224 437.391 219.786 427.217 212.284 419.716C204.783 412.214 194.609 408 184 408C173.391 408 163.217 412.214 155.716 419.716C148.214 427.217 144 437.391 144 448ZM144 720C144 730.609 148.214 740.783 155.716 748.284C163.217 755.786 173.391 760 184 760C194.609 760 204.783 755.786 212.284 748.284C219.786 740.783 224 730.609 224 720C224 709.391 219.786 699.217 212.284 691.716C204.783 684.214 194.609 680 184 680C173.391 680 163.217 684.214 155.716 691.716C148.214 699.217 144 709.391 144 720Z\" fill=\"black\"/>
                            </svg>
                        </div>
                        There is no result for your reseach
                    </section>
                ";
            }

            else {
                $customers = getCustomers();
            }

            if(!empty($customers)) {
                if(count($customers)>0) {
                    foreach ($customers as $customer) {
                    echo 
                    "   <section class=\"print_customer\"> 
                            <div class=\"profil\">
                                <img src=\"../Icones/user_icon.png\" style=\"width:50px;\">
                                <div>
                                    <strong>".$customer->getUser_name()." ".$customer->getPostName()."</strong><br>
                                    <span>".$customer->getMail_address()."</span> 
                                </div>
                            </div>

                            <div style=\"width:10%; display:flex; flex-direction:column;align-items:center;\">
                                <h4>Contacts</h4>
                                ".$customer->getPhone_number()."<br>
                            </div>

                            <div style=\"width:30%; display:flex; flex-direction:column;align-items:center;\">
                                <h4>Address</h4>
                                ".$customer->getLocal_address()."
                            </div>

                            <div style=\"width:7%; display:flex; flex-direction:column;align-items:center;\">
                                <h4>Solde (USD)</h4>
                                ".$customer->getSolde()."
                            </div>

                            <div class=\"modifier_customer\">
                                <form action='./v_deposit_remove.php' method='POST'>
                                    <input type='hidden' name='id_customer' value='".$customer->getCustomerId($customer)."'>
                                    <button type='submit' class=\"edite_btn\" style=\"border:0px; cursor:pointer; width:50px; height:60px; background-color:white; color:#00B050;\">
                                        <svg  viewBox=\"0 0 32 32\" fill=\"#00B050\" xmlns=\"http://www.w3.org/2000/svg\">
                                        <path d=\"M20 20H30V22H20V20ZM20 24H30V26H20V24ZM20 28H30V30H20V28ZM16 20C15.4714 20.012 14.9459 19.9168 14.4552 19.72C13.9644 19.5233 13.5186 19.2291 13.1448 18.8552C12.7709 18.4814 12.4767 18.0356 12.28 17.5449C12.0832 17.0541 11.988 16.5286 12 16C11.988 15.4714 12.0832 14.9459 12.28 14.4552C12.4767 13.9644 12.7709 13.5186 13.1448 13.1448C13.5186 12.7709 13.9644 12.4767 14.4552 12.28C14.9459 12.0832 15.4714 11.988 16 12C16.5286 11.988 17.0541 12.0832 17.5449 12.28C18.0356 12.4767 18.4814 12.7709 18.8552 13.1448C19.2291 13.5186 19.5233 13.9644 19.72 14.4552C19.9168 14.9459 20.012 15.4714 20 16H22C22 14.8133 21.6481 13.6533 20.9888 12.6666C20.3295 11.6799 19.3925 10.9109 18.2961 10.4567C17.1997 10.0026 15.9933 9.88378 14.8295 10.1153C13.6656 10.3468 12.5965 10.9182 11.7574 11.7574C10.9182 12.5965 10.3468 13.6656 10.1153 14.8295C9.88378 15.9933 10.0026 17.1997 10.4567 18.2961C10.9109 19.3925 11.6799 20.3295 12.6666 20.9888C13.6533 21.6481 14.8133 22 16 22V20Z\" fill=\"#00B050\"/>
                                        <path d=\"M29.3052 11.044L26.9452 6.956C26.7143 6.555 26.3514 6.24656 25.9185 6.08334C25.4855 5.92011 25.0093 5.91221 24.5712 6.061L22.1372 6.885C21.7177 6.60259 21.2793 6.34933 20.8252 6.127L20.3212 3.607C20.2303 3.1538 19.9853 2.74604 19.6278 2.45307C19.2703 2.1601 18.8224 2 18.3602 2H13.6402C13.1778 2.00005 12.7298 2.16029 12.3722 2.45346C12.0147 2.74663 11.7698 3.15461 11.6792 3.608L11.1752 6.127C10.7159 6.34689 10.2725 6.5985 9.84816 6.88L7.42816 6.061C6.99029 5.91274 6.51456 5.9209 6.08203 6.0841C5.6495 6.2473 5.28695 6.55544 5.05616 6.956L2.69616 11.044C2.46498 11.4443 2.37959 11.9123 2.45452 12.3685C2.52945 12.8246 2.76007 13.2407 3.10716 13.546L5.03816 15.243C5.02116 15.495 5.00016 15.745 5.00016 16C5.00016 16.258 5.01016 16.513 5.02816 16.766L3.10816 18.454C2.76075 18.759 2.52974 19.175 2.45444 19.6312C2.37914 20.0873 2.46421 20.5555 2.69516 20.956L5.05516 25.044C5.28603 25.445 5.64892 25.7534 6.08188 25.9167C6.51484 26.0799 6.99103 26.0878 7.42916 25.939L9.86316 25.115C10.2825 25.3979 10.7209 25.6515 11.1752 25.874L11.6782 28.392C11.7688 28.8456 12.0139 29.2537 12.3716 29.5469C12.7293 29.84 13.1776 30.0002 13.6402 30H16.0002V28H13.6402L12.9302 24.45C11.948 24.0851 11.0362 23.5533 10.2352 22.878L6.78816 24.044L4.42816 19.956L7.15316 17.561C6.96673 16.5269 6.96436 15.468 7.14616 14.433L4.42816 12.043L6.78816 7.956L10.2152 9.116C11.022 8.43973 11.9408 7.90975 12.9302 7.55L13.6402 4H18.3602L19.0702 7.55C20.0523 7.91491 20.964 8.44673 21.7652 9.122L25.2122 7.956L27.5722 12.044L24.7742 14.496L26.0922 16L28.8922 13.546C29.2396 13.241 29.4706 12.825 29.5459 12.3688C29.6212 11.9127 29.5361 11.4445 29.3052 11.044Z\" fill=\"#00B050\"/>
                                        </svg>
                                    </button>
                                </form>
                                
                                <form action='../Controllers/c_delete_customer.php' method='POST'>
                                    <input type='hidden' name='id_customer' value='".$customer->getCustomerId($customer)."'>
                                    <button type='submit' class=\"delete_btn\" style=\"border:0px; cursor:pointer; width:50px; height:60px; background-color:white;\">
                                        <svg viewBox=\"0 0 62 74\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">
                                        <path d=\"M25.4645 15.8572H36.5359C36.5359 14.1049 35.9527 12.4243 34.9146 11.1852C33.8764 9.94616 32.4684 9.25005 31.0002 9.25005C29.532 9.25005 28.124 9.94616 27.0859 11.1852C26.0477 12.4243 25.4645 14.1049 25.4645 15.8572ZM22.1431 15.8572C22.1431 13.0535 23.0762 10.3646 24.7373 8.38207C26.3983 6.39954 28.6512 5.28577 31.0002 5.28577C33.3493 5.28577 35.6021 6.39954 37.2632 8.38207C38.9242 10.3646 39.8574 13.0535 39.8574 15.8572H53.6966C54.1371 15.8572 54.5595 16.066 54.8709 16.4378C55.1824 16.8095 55.3574 17.3136 55.3574 17.8393C55.3574 18.365 55.1824 18.8692 54.8709 19.2409C54.5595 19.6126 54.1371 19.8215 53.6966 19.8215H50.7959L48.1011 58.4151C47.9051 61.2227 46.8322 63.8398 45.0952 65.7475C43.3583 67.6552 41.0841 68.7141 38.7236 68.7143H23.2768C20.9163 68.7141 18.6421 67.6552 16.9052 65.7475C15.1682 63.8398 14.0953 61.2227 13.8993 58.4151L11.2045 19.8215H8.30378C7.86333 19.8215 7.44092 19.6126 7.12948 19.2409C6.81803 18.8692 6.64307 18.365 6.64307 17.8393C6.64307 17.3136 6.81803 16.8095 7.12948 16.4378C7.44092 16.066 7.86333 15.8572 8.30378 15.8572H22.1431ZM17.2096 58.0848C17.3363 59.9015 18.0303 61.5951 19.1541 62.8297C20.2779 64.0643 21.7494 64.7497 23.2768 64.7501H38.7236C40.251 64.7497 41.7225 64.0643 42.8463 62.8297C43.9701 61.5951 44.6642 59.9015 44.7908 58.0848L47.4656 19.8215H14.537L17.2096 58.0848ZM26.0181 29.0715C26.4585 29.0715 26.8809 29.2803 27.1924 29.652C27.5038 30.0238 27.6788 30.5279 27.6788 31.0536V53.5179C27.6788 54.0436 27.5038 54.5478 27.1924 54.9195C26.8809 55.2912 26.4585 55.5001 26.0181 55.5001C25.5776 55.5001 25.1552 55.2912 24.8438 54.9195C24.5323 54.5478 24.3574 54.0436 24.3574 53.5179V31.0536C24.3574 30.5279 24.5323 30.0238 24.8438 29.652C25.1552 29.2803 25.5776 29.0715 26.0181 29.0715ZM37.6431 31.0536C37.6431 30.5279 37.4681 30.0238 37.1567 29.652C36.8452 29.2803 36.4228 29.0715 35.9824 29.0715C35.5419 29.0715 35.1195 29.2803 34.8081 29.652C34.4966 30.0238 34.3216 30.5279 34.3216 31.0536V53.5179C34.3216 54.0436 34.4966 54.5478 34.8081 54.9195C35.1195 55.2912 35.5419 55.5001 35.9824 55.5001C36.4228 55.5001 36.8452 55.2912 37.1567 54.9195C37.4681 54.5478 37.6431 54.0436 37.6431 53.5179V31.0536Z\" fill=\"red\"/>
                                        </svg>
                                    </button>
                                </form>
                            </div>

                            <div class=\"num\">
                                ".$customer->getCustomerId($customer)."
                            </div>
                        </section>
                    ";
                    }
                }

                else {
                    echo 
                    "
                        <section class=\"print_customer\" style='flex-direction:column ; justify-content:space-around;'>
                            <div style='width:100px; height:128px; margin-bottom:0px;'>
                                <svg viewBox=\"0 0 704 896\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">
                                <path d=\"M672 0H32C14.3 0 0 14.3 0 32V864C0 881.7 14.3 896 32 896H672C689.7 896 704 881.7 704 864V32C704 14.3 689.7 0 672 0ZM72 72H632V280H72V72ZM632 552H72V344H632V552ZM632 824H72V616H632V824ZM144 176C144 186.609 148.214 196.783 155.716 204.284C163.217 211.786 173.391 216 184 216C194.609 216 204.783 211.786 212.284 204.284C219.786 196.783 224 186.609 224 176C224 165.391 219.786 155.217 212.284 147.716C204.783 140.214 194.609 136 184 136C173.391 136 163.217 140.214 155.716 147.716C148.214 155.217 144 165.391 144 176ZM144 448C144 458.609 148.214 468.783 155.716 476.284C163.217 483.786 173.391 488 184 488C194.609 488 204.783 483.786 212.284 476.284C219.786 468.783 224 458.609 224 448C224 437.391 219.786 427.217 212.284 419.716C204.783 412.214 194.609 408 184 408C173.391 408 163.217 412.214 155.716 419.716C148.214 427.217 144 437.391 144 448ZM144 720C144 730.609 148.214 740.783 155.716 748.284C163.217 755.786 173.391 760 184 760C194.609 760 204.783 755.786 212.284 748.284C219.786 740.783 224 730.609 224 720C224 709.391 219.786 699.217 212.284 691.716C204.783 684.214 194.609 680 184 680C173.391 680 163.217 684.214 155.716 691.716C148.214 699.217 144 709.391 144 720Z\" fill=\"black\"/>
                                </svg>
                            </div>
                            No customers are registered
                        </section>
                    ";
                }
            }
        ?>
</body>
</html>